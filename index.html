<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <title>Band Event Cost App</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="stylesheet" href="styles.css"/>
<!--    <script src="js/bandCalculator.js"></script>-->
<!--    <script src="js/fuelCalculator.js"></script>-->
<!--    <script src="js/calendar.js"></script>-->
<!--    <script src="js/main.js"></script>-->
</head>
<body>

<!-- MAIN: Band & Expense Calculator -->
<div class="container main-app">
    <h2>ğŸ¸ The Loopers Band Cost Estimator</h2>
    <form id="bandForm">
        <label for="pricePerPerson">ğŸ’¶ Price per Person (â‚¬):</label>
        <input type="number" id="pricePerPerson" placeholder="e.g. 200" required/>

        <label for="numPeople">ğŸ‘¥ Number of People:</label>
        <input type="number" id="numPeople" placeholder="e.g. 5" required/>

        <label for="soundCost">ğŸ”Š Sound Cost (â‚¬):</label>
        <input type="number" id="soundCost" placeholder="e.g. 450"/>

        <label for="dubaRental">ğŸš Van Rental (â‚¬):</label>
        <input type="number" id="dubaRental" placeholder="e.g. 100"/>

        <label for="dubaTransport">â›½ Van Fuel Cost (â‚¬):</label>
        <input type="number" id="dubaTransport" placeholder="e.g. 80"/>

        <label for="valiTransport">â›½ Vali Fuel Cost (â‚¬):</label>
        <input type="number" id="valiTransport" placeholder="e.g. 70"/>

        <label for="cantatBiserica"> â›ª Church Singing (â‚¬):</label>
        <input type="number" id="cantatBiserica" placeholder="e.g. 200"/>

        <label class="switch">
            <input type="checkbox" id="needHotel"/>
            ğŸ¨ Need hotel accommodation
            <span class="slider"></span>
        </label>

        <button type="submit">Calculate Total</button>
    </form>
    <div class="result" id="bandResult"></div>
    <button id="downloadBtn" style="display:none; margin-top: 10px;">â¬‡ï¸ Download Summary</button>
    <button id="calendarBtn" style="display:none; margin-top: 10px;">ğŸ“… Add to Calendar</button>
</div>

<!-- SECONDARY: Fuel Calculator & Map -->
<div class="container secondary-app">
    <h2>ğŸ’¶ Fuel Cost Helper</h2>
    <form id="calcForm">
        <label for="distance">Distance (km):</label>
        <input type="number" id="distance" placeholder="e.g. 150" required/>

        <label for="consumption">Consumption (L/100km):</label>
        <input type="number" id="consumption" step="0.1" placeholder="e.g. 8" required/>

        <button type="submit">Calculate Fuel Cost</button>
    </form>
    <div class="result" id="result"></div>
</div>

<!-- JavaScript -->
<script>
    // // Fuel Cost Calculator
    document.getElementById("calcForm").addEventListener("submit", function (e) {
        e.preventDefault();
        const km = parseFloat(document.getElementById('distance').value);
        const rawConsumption = parseFloat(document.getElementById('consumption').value);
        const resultEl = document.getElementById('result');

        if (isNaN(km) || isNaN(rawConsumption)) {
            resultEl.textContent = "âš ï¸ Please enter valid numbers.";
            resultEl.style.color = "#D32F2F";
            return;
        }

        const consumption = rawConsumption / 100;
        const result = ((km * consumption) * 8) / 5;

        resultEl.style.color = "#2e7d32";
        resultEl.innerHTML =
            `<div style="font-size: 1.8rem; font-weight: bold; color: #2e7d32; margin-top: 10px;">
            â›½ FUEL COST: â‚¬${result.toFixed(2)}
        </div>`;
    });

    // Band Cost Calculator
    document.getElementById("bandForm").addEventListener("submit", function (e) {
        e.preventDefault();

        const pricePerPerson = parseFloat(document.getElementById('pricePerPerson').value);
        const numPeople = parseInt(document.getElementById('numPeople').value);
        const sound = parseFloat(document.getElementById('soundCost').value) || 0;
        const dubaRental = parseFloat(document.getElementById('dubaRental').value) || 0;
        const dubaTransport = parseFloat(document.getElementById('dubaTransport').value) || 0;
        const valiTransport = parseFloat(document.getElementById('valiTransport').value) || 0;
        const cantatBiserica = parseFloat(document.getElementById('cantatBiserica').value) || 0;
        const needHotel = document.getElementById('needHotel').checked;
        const resultEl = document.getElementById('bandResult');

        if (isNaN(pricePerPerson) || isNaN(numPeople)) {
            resultEl.textContent = "âš ï¸ Please enter the required fields.";
            resultEl.style.color = "#D32F2F";
            return;
        }

        const bandTotal = pricePerPerson * numPeople;
        const extras = sound + dubaRental + dubaTransport + valiTransport + cantatBiserica;
        const total = bandTotal + extras;

        const expirationDate = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000);
        const day = String(expirationDate.getDate()).padStart(2, '0');
        const month = String(expirationDate.getMonth() + 1).padStart(2, '0'); // Months are 0-indexed
        const year = expirationDate.getFullYear();
        const offerExpiration = `${day}-${month}-${year}`;

        // Prepare the biserica line if applicable
        let bisericaLine = "";
        if (cantatBiserica > 0) {
            bisericaLine = `<li>+cantat la ceremonia religioasa pian si voce 2-4 piese</li>`;
        }

        // Prepare hotel line if needed
        let hotelLine = "";
        if (needHotel) {
            hotelLine = `<li>â â 1 noapte de cazare din <em><b>XX->XX MONTH</b></em> pentru 5 sau 6 persoane in functie de pachetul ales</li>`;
        }

        resultEl.innerHTML = `
    <div style="font-size: 1rem; color: #555;">ğŸµ Band: â‚¬${bandTotal.toFixed(2)}</div>
    <div style="font-size: 1rem; color: #777;">â• Extras: â‚¬${extras.toFixed(2)}</div>
    <div style="font-size: 1.8rem; font-weight: bold; color: #2e7d32; margin-top: 10px;">
        ğŸ§¾ TOTAL PRICE: â‚¬${total}
    </div>

    <div style="margin-top: 30px; text-align: left; color: #333; line-height: 1.6;">
        <p>==================================</p>
        <p>Salut CLIENT,</p>
        <p>Am revenit cu oferta pentru <strong>DATE</strong>, <strong>LOCATION</strong></p>

        <h3>Ce oferim la eveniment:</h3>
        <ul>
            <li>âœ… Garanta ca vom oferi momente de neuitat care vor dainui o viata intreaga pentru voi cat si pentru invitatii vostri</li>
            <li>âœ… Momente speciale:
                <ul>
                    <li>â  â Intrare miri cu muzicÄƒ live</li>
                    <li>â  â 3-4-5 sesiuni live (30-40 min) in functie de felurile de mancare servite</li>
                    <li>â  â Concert interactiv cu invitaÈ›ii (in functie de dorinta voastra si vibe)</li>
                    <li>â  â Moment muzical la intrarea tortului</li>
                    <li>â  â Anunturi</li>
                </ul>
            </li>
            <li>âœ… Repertoriu variat: Jazz, lounge, pop, piese creÈ™tine</li>
            <li>âœ… Flexibilitate: AdaptÄƒm volumul È™i dinamica muzicii Ã®n funcÈ›ie de atmosferÄƒ</li>
            <li>âœ… Sunet: Asiguram sunetul pe durata evenimentului la masa</li>
        </ul>

        <h3>Pachete disponibile:</h3>
        <p>ğŸµ<b>Full Band</b> â€“ â‚¬${total}
        <ul>
        <li>
        Pian, voce, tobe, bass, chitara electrica, saxofon, sunet</li>
        ${bisericaLine}
</ul>
        </p>


        <p>ğŸµ<b>Small Band</b> â€“ â‚¬${total - pricePerPerson}
        <ul>
            <li>
                Pian, voce, tobe, bass, sunet, chitara electrica, <b>SAU</b> saxofon</li>
            ${bisericaLine}
        </ul>
        </p>


        <h3>ğŸš©Costuri adiÈ›ionale:</h3>
        <ul>
            <li>â  â Avans: â‚¬350 pentru rezervarea datei (restul la finalul nunÈ›ii, Ã®n valutÄƒ)</li>
                ${hotelLine}
            <li>â  â In onorariul mentionat mai sus este <strong>inclus</strong> si transportul</li>
        </ul>

        <h3>ğŸš©OpÈ›iuni suplimentare:</h3>
        <ul>
            <li>â  â Momente personalizate pe parcursul evenimentului</li>
        </ul>

        <p>
            ğŸ”· Oferta valabila pana la data de <strong>${offerExpiration}</strong><br/>
            ğŸ”· Pentru orice fel de intrebari va stam la dispozitie pentru a le discuta si a va ajuta cu raspuns si gidare.<br/>
            ğŸ”· DacÄƒ oferta este pe placul vostru, blocÄƒm data prin achitarea avansului.
        </p>
        <p>=================================</p>
    </div>`;


        // show church singing line if applicable
        const cantatBisericaLine = cantatBiserica > 0
            ? `- â›ª Church singing: â‚¬${cantatBiserica.toFixed(2)}\n`
            : "";

        const hotel = needHotel === true
            ? "- ğŸ¨ 1 noapte de cazare din XX->XX MONTH pentru 5 sau 6 persoane"
            : "";

        const summaryLines = [
            `- ğŸ’¶ Band price per person: â‚¬${pricePerPerson.toFixed(2)}`,
            `- ğŸ‘¥ Number of people: ${numPeople}`,
            `- ğŸ”Š Sound cost: â‚¬${sound.toFixed(2)}`,
            `- ğŸš Van rental: â‚¬${dubaRental.toFixed(2)}`,
            `- â›½ Van fuel cost: â‚¬${dubaTransport.toFixed(2)}`,
            `- â›½ Vali fuel cost: â‚¬${valiTransport.toFixed(2)}`,
            cantatBisericaLine.trim(),
            hotel.trim()
        ].filter(line => line).join('\n');

        const summaryText = `
ğŸ§¾ TOTAL PRICE: â‚¬${total.toFixed(2)}

${summaryLines}
`;

        const calendarBtn = document.getElementById("calendarBtn");
        calendarBtn.style.display = "block";
        calendarBtn.onclick = () => createICSFile(summaryText);
    });

    function createICSFile(summaryText) {
        const now = new Date();
        const startDate = now.toISOString().split("T")[0].replace(/-/g, "");
        const endDate = new Date(now.getTime() + 86400000).toISOString().split("T")[0].replace(/-/g, "");

        const icsContent = `
BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//YourApp//BandEvent//EN
BEGIN:VEVENT
UID:${Date.now()}@bandevent.com
DTSTAMP:${startDate}T000000Z
DTSTART;VALUE=DATE:${startDate}
DTEND;VALUE=DATE:${endDate}
SUMMARY:ğŸ¸ Nunta Loopers
DESCRIPTION:${summaryText.replace(/\n/g, "\\n")}
END:VEVENT
END:VCALENDAR`.trim();

        const blob = new Blob([icsContent], {type: "text/calendar;charset=utf-8"});
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "Band_Event.ics";
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
    }
</script>
</body>
</html>
